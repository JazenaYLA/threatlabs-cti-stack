###########################
# DEPENDENCIES            #
###########################

MINIO_ROOT_USER=opencti
MINIO_ROOT_PASSWORD=changeme                          # [CRITICAL] Generate: openssl rand -hex 32
RABBITMQ_DEFAULT_USER=opencti
RABBITMQ_DEFAULT_PASS=changeme                        # [CRITICAL] Generate: openssl rand -hex 32

# Database (Postgres) — shared from infra/init-dbs.sh
POSTGRES_USER=openaev                                 # Must match infra/init-dbs.sh
POSTGRES_PASSWORD=changeme                            # [CRITICAL] Must match infra/.env
OPENAEV_DB_NAME=openaev                               # [OPTIONAL] Database name (default: openaev)

# ElasticSearch / OpenSearch
ELASTIC_MEMORY_SIZE=8G                                # Adjust based on host RAM (16GB→2G, 32GB→4G, 64GB→8G)
OPENSEARCH_ADMIN_PASSWORD=changeme

# Emails (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=ChangeMe@domain.com
SMTP_PASSWORD=ChangeMe
SMTP_AUTH=true
SMTP_SSL_ENABLE=true
SMTP_STARTTLS_ENABLE=false

# Emails (IMAP — Optional, for OpenAEV email integration)
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_USERNAME=ChangeMe@domain.com
IMAP_PASSWORD=ChangeMe
IMAP_AUTH=true
IMAP_SSL_ENABLE=true
IMAP_STARTTLS_ENABLE=false

###########################
# COMMON                  #
###########################

COMPOSE_PROJECT_NAME=xtm
XTM_COMPOSER_ID=ChangeMe_UUIDv4                      # [CRITICAL] Generate: uuidgen
XTM_ORGANIZATION_NAME=MyOrganization

###########################
# OPENCTI                 #
###########################

OPENCTI_HOST=localhost
OPENCTI_PORT=8080
OPENCTI_EXTERNAL_SCHEME=http
OPENCTI_ADMIN_EMAIL=admin@opencti.io                  # [CRITICAL] Your admin email
OPENCTI_ADMIN_PASSWORD=changeme                       # [CRITICAL] Your admin password
OPENCTI_ADMIN_TOKEN=ChangeMe_UUIDv4                   # [CRITICAL] Generate: uuidgen
OPENCTI_HEALTHCHECK_ACCESS_KEY=changeme               # Generate: openssl rand -hex 32

###############################################
# OPENCTI CONNECTORS (Default / Required)     #
# These are part of the official XTM install. #
# Each ID must be a unique UUIDv4.            #
###############################################

# --- Core Import/Export (Required) ---
# Export connectors must run as admin (bypass needed for user impersonation).
# All other connectors auto-create a service account on first registration.
CONNECTOR_EXPORT_FILE_STIX_ID=ChangeMe_UUIDv4
CONNECTOR_EXPORT_FILE_CSV_ID=ChangeMe_UUIDv4
CONNECTOR_EXPORT_FILE_TXT_ID=ChangeMe_UUIDv4
CONNECTOR_IMPORT_FILE_STIX_ID=ChangeMe_UUIDv4
CONNECTOR_IMPORT_DOCUMENT_ID=ChangeMe_UUIDv4
CONNECTOR_IMPORT_FILE_YARA_ID=ChangeMe_UUIDv4
CONNECTOR_IMPORT_EXTERNAL_REFERENCE_ID=ChangeMe_UUIDv4
CONNECTOR_ANALYSIS_ID=ChangeMe_UUIDv4

# --- Default Data Sources (Required) ---
# These auto-create service accounts with confidence level 75-100.
CONNECTOR_OPENCTI_ID=ChangeMe_UUIDv4                  # OpenCTI default datasets (markings, identities)
CONNECTOR_MITRE_ID=ChangeMe_UUIDv4                    # MITRE ATT&CK framework

# --- Optional Data Sources ---
# Cortex Connector (Example)
# CONNECTOR_CORTEX_ID=ChangeMe_UUIDv4
# CONNECTOR_CORTEX_URL=http://<cortex-ip>:9001
# CONNECTOR_CORTEX_REALM=cortex
# CONNECTOR_CORTEX_KEY=ChangeMe

###############################################
# OPTIONAL CONNECTORS (Uncomment to enable)   #
# Requires corresponding service definitions  #
# in docker-compose.yml to also be uncommented#
###############################################

## MISP Integration (requires running MISP instance)
#CONNECTOR_MISP_ID=ChangeMe_UUIDv4
#CONNECTOR_MISP_KEY=ChangeMe                          # MISP API auth key
#CONNECTOR_MISP_URL=http://misp-misp-core-1:80        # Internal docker network URL
#MISP_IMPORT_FROM_DATE=2020-01-01

## TheHive Integration (requires running TheHive instance)
#CONNECTOR_THEHIVE_ID=ChangeMe_UUIDv4
#CONNECTOR_THEHIVE_KEY=ChangeMe                       # TheHive API key
#CONNECTOR_THEHIVE_URL=http://thehive-cti:9000        # Internal docker network URL

## AlienVault OTX
#CONNECTOR_OTX_ID=ChangeMe_UUIDv4
#CONNECTOR_OTX_KEY=ChangeMe                           # OTX API key from otx.alienvault.com
#CONNECTOR_OTX_URL=https://otx.alienvault.com

## CAPE Sandbox
#CONNECTOR_CAPE_ID=ChangeMe_UUIDv4
#CONNECTOR_CAPE_KEY=ChangeMe
#CONNECTOR_CAPE_URL=https://capesandbox.com/accounts/login/?next=

## Malpedia
#CONNECTOR_MALPEDIA_ID=ChangeMe_UUIDv4
#CONNECTOR_MALPEDIA_KEY=ChangeMe                      # Malpedia API key

## MalwareBazaar
#CONNECTOR_MALWAREBAZAAR_ID=ChangeMe_UUIDv4
#CONNECTOR_MALWAREBAZAAR_KEY=ChangeMe

## MalwareBazaar Recent Additions
#CONNECTOR_MALWAREBAZAAR_RECENT_ID=ChangeMe_UUIDv4
#CONNECTOR_MALWAREBAZAAR_RECENT_KEY=ChangeMe

## Shodan
#CONNECTOR_SHODAN_ID=ChangeMe_UUIDv4
#CONNECTOR_SHODAN_KEY=ChangeMe                        # Shodan API key

## Malbeacon
#CONNECTOR_MALBEACON_ID=ChangeMe_UUIDv4
#CONNECTOR_MALBEACON_KEY=ChangeMe

## IPInfo
#CONNECTOR_IPINFO_ID=ChangeMe_UUIDv4
#CONNECTOR_IPINFO_KEY=ChangeMe                        # ipinfo.io API key

## UnpacMe
#CONNECTOR_UNPAC_ME_API_KEY=ChangeMe

## AbuseIPDB
#CONNECTOR_ABUSEIPDB_API_KEY=ChangeMe

## Hybrid Analysis
#CONNECTOR_HYBRID_ANALYSIS_TOKEN=ChangeMe
#CONNECTOR_HYBRID_ANALYSIS_SECRET=ChangeMe

## Hatching Triage Sandbox
#CONNECTOR_HATCHING_TRIAGE_SANDBOX_TOKEN=ChangeMe

###########################
# OPENAEV                 #
###########################
# Note: OPENCTI_HOST, OPENCTI_PORT, OPENCTI_EXTERNAL_SCHEME are defined in the OPENCTI section above

OPENAEV_HOST=localhost
OPENAEV_PORT=8081
OPENAEV_EXTERNAL_SCHEME=http
OPENAEV_XTM_OPENCTI_ID=ChangeMe_UUIDv4               # [CRITICAL] Connector ID for OpenAEV→OpenCTI link
OPENAEV_ADMIN_EMAIL=admin@openaev.io                  # [CRITICAL] Your admin email
OPENAEV_ADMIN_PASSWORD=changeme                       # [CRITICAL] Your admin password
OPENAEV_ADMIN_TOKEN=ChangeMe_UUIDv4                   # [CRITICAL] Generate: uuidgen
OPENAEV_ADMIN_ENCRYPTION_SALT=ChangeMe_UUIDv4         # [CRITICAL] Generate: uuidgen
OPENAEV_ADMIN_ENCRYPTION_PASSWORD=changeme            # [CRITICAL] Generate: openssl rand -hex 32
OPENAEV_HEALTHCHECK_KEY=changeme                      # Generate: openssl rand -hex 32
OPENAEV_MAIL_IMAP_ENABLED=false

###########################
# OPENAEV COLLECTORS      #
###########################

COLLECTOR_MITRE_ATTACK_ID=ChangeMe_UUIDv4
COLLECTOR_OPENAEV_ID=ChangeMe_UUIDv4
COLLECTOR_ATOMIC_RED_TEAM_ID=ChangeMe_UUIDv4
COLLECTOR_NVD_NIST_CVE_ID=ChangeMe_UUIDv4
COLLECTOR_NVD_NIST_CVE_API_KEY=                       # Optional but recommended (from nvd.nist.gov)

###########################
# OPENAEV INJECTORS       #
###########################

INJECTOR_NMAP_ID=ChangeMe_UUIDv4
INJECTOR_NUCLEI_ID=ChangeMe_UUIDv4

# OpenAEV Database Password (must match infra/.env)
OPENAEV_DB_PASSWORD=changeme                          # [CRITICAL] Must match infra/init-dbs.sh
